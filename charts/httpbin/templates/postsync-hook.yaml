apiVersion: batch/v1
kind: Job
metadata:
  name: httpbin-postsync
  annotations:
    "argocd.argoproj.io/hook": PostSync
    # "argocd.argoproj.io/hook-delete-policy": HookSucceeded
spec:
  template:
    spec:
      containers:
        - name: curl-container
          image: curlimages/curl:latest
          command: ["/bin/sh"]
          args:
            - "-c"
            - |
              echo "Curling httpbin service inside the cluster...";
              curl -v -X GET "http://httpbin.default.svc.cluster.local/get" -H "accept: application/json"
      restartPolicy: Never
      terminationGracePeriodSeconds: 10
